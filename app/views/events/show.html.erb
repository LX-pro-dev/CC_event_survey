<p id="notice"><%= notice %></p>

<h1>Surveys from <%= @event.id %></h1>
<% Event::STATUSES.each do |status| %>
  <td><%= link_to change_status_event_path(@event, status: status), class: "btn btn-primary", method: :patch do %>
    <%= status %></td>
  <% end %>
<% end %>

<p>
  <strong>Status:</strong>
  <%= @event.status %>
</p>

<p>
  <strong>Total event:</strong>
  <%= @event.surveys.sum{|survey| survey.total} %>
</p>

<p>
  <strong>Nb participants:</strong>
  <%= @event.nb_participants %>
</p>
<table> 
  <thead>
      <tr>
        <th>Id</th>
        <th>Tasty</th>
        <th>Presentation</th>
        <th>Atmosphere</th>
        <th>Total</th>
        <th colspan="3"></th>
      </tr>
    </thead>
  </tbody>
    <% @surveys = [] %>
    <% @surveys = @event.surveys %>
    <% @surveys.each do |survey| %>
      <tr>
        <% if survey.event_id == @event.id %> 
          <td><%= survey.id %></td>
          <td><%= survey.tasty %></td>
          <td><%= survey.presentation %></td>
          <td><%= survey.atmosphere %></td>
          <td><%= survey.total %></td>

          <td><%= link_to 'Show', survey %></td>
          <td><%= link_to 'Edit', edit_survey_path(survey) %></td>
          <td><%= link_to 'Destroy', survey, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
<%= link_to 'Edit', edit_event_path(@event) %> |
<%= link_to 'Back', events_path %>
